---

- name: Update application repo
  git:
    repo: "{{money_tracker.repo}}"
    dest: "{{money_tracker.app_path}}"
    accept_hostkey: Yes
    clone: no
    update: yes
    force: yes
  tags: [updating]

- name: Stop docker containers
  shell: "./docker/manager.sh stop"
  args:
    chdir: "{{money_tracker.app_path}}"
  tags: [updating]

- name: Build docker containers
  shell: "./docker/manager.sh build"
  args:
    chdir: "{{money_tracker.app_path}}"
  tags: [updating]
  register: build_result

- name: The result of building containers command
  debug:
    var: build_result
  tags: [updating]

- name: Run docker containers
  shell: "./docker/manager.sh run"
  args:
    chdir: "{{money_tracker.app_path}}"
  tags: [updating]
